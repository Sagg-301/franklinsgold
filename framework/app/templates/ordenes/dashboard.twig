{% extends 'overall/layout' %}
{% block appBody %}
<div id="page-wrapper" class="gray-bg">
<div class="row border-bottom">
    {% include 'overall/header' %}
</div>

            <div class="wrapper wrapper-content">
            	<div class="row">
            		<div class="col-md-12">
                   {#<a onclick="showModal('intercambioModal','{{ultimo_precio_oro}}','{{ultimo_precio_plata}}')" class="btn btn-warning btn-rounded" style="float:right; margin-bottom:10px;margin-left:5px;"><i class="fa fa-check"></i> Intercambiar</a>#}
                   <a onclick="showModal('ventaModal',{{ultimo_precio_oro}},{{ultimo_precio_plata}},{{precio_bolivar}})" class="btn btn-warning btn-rounded" style="float:right; margin-bottom:10px;margin-left:5px;"><i class="fa fa-check"></i> Vender</a>
                    <a onclick="showModal('compraModal',{{ultimo_precio_oro}},{{ultimo_precio_plata}},{{precio_bolivar}})" class="btn btn-warning btn-rounded" style="float:right; margin-bottom:10px;margin-left:5px;"><i class="fa fa-check"></i> Comprar</a>
            		</div>
            	</div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="ibox float-e-margins">
                            <div class="ibox-content">
                                    <div>
                                        <h3 class="font-bold no-margins">
                                            Precio del oro (USD)
                                        </h3>
                                    </div>

                                <div>
                                    <canvas id="lineChart" height="40" width="100%"></canvas>
                                </div>

                                <div class="m-t-md">
                                    <small class="pull-right">
                                        <i class="fa fa-clock-o"> </i>
                                        <i id="fecha_oro"> </i>
                                    </small>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="ibox float-e-margins">
                            <div class="ibox-content">
                                    <div>
                                        <h3 class="font-bold no-margins">
                                            Precio de la plata (USD)
                                        </h3>
                                    </div>

                                <div>
                                    <canvas id="plataChart" height="40" width="100%"></canvas>
                                </div>

                                <div class="m-t-md">
                                    <small class="pull-right">  
                                        <i class="fa fa-clock-o"> </i>                                     
                                        <i id="fecha_plata"></i>
                                    </small>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-3">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>Gramos comprados en oro</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">{{total_oro_comprado == null ? 0 : total_oro_comprado}}</h1>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>Total de oro en dólares</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">{{ ((total_oro_comprado * (ultimo_precio_oro / 28.3495))|round(2, 'ceil'))|number_format(2, ',', '.') }}</h1>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>Gramos comprados en plata</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">{{total_plata_comprado == null ? 0 : total_plata_comprado}}</h1>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>Total de plata en dólares</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">{{ ((total_plata_comprado * (ultimo_precio_plata / 28.3495))|round(2, 'ceil'))|number_format(2, ',', '.') }}</h1>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-lg-6">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>Últimas transacciones realizadas de oro</h5>
                            </div>
                            <div class="ibox-content">
                                 <div class="table-responsive">
                                    <table class="table table-striped table-bordered table-hover tablita" >
                                        <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Usuario</th>
                                            <!--<th>Sucursal</th>-->
                                            <th>Cantidad</th>
                                            <th>Precio</th>
                                            <th>Monto(USD)</th>
                                            <th>Tipo</th>
                                        </tr>
                                        </thead>
                                        <tbody>  
                                            {% for a in ultimas_cinco_ordenes_oro %} 
                                            <tr>
                                                <td>{{ fecha('D, d F, Y h:i a', a.fecha) }}</td>
                                                <td>{{ a.primer_nombre }} {{ a.primer_apellido }}</td>
                                                {#<td>{{ a.nombre_sucursal }}</td>#}
                                                <td>{{ a.cantidad }}</td>
                                                <td>{{ a.precio|number_format(2, ',', '.') }}</td>
                                                <td>{{ (a.cantidad * (a.precio / 28.3495))|number_format(2, ',', '.') }}</td>
                                                <td style="{{a.tipo_orden == 1 ? 'color: #DC2929;' :  a.tipo_orden == 2  ? 'color: red;' : 'color: #3CD219;'}}">{{ a.tipo_orden == 1 ? 'Compra' :  a.tipo_orden == 2  ? "Venta" : "Intercambio" }}</td>
                                            </tr>
                                            {% endfor %}  
                                        </tbody>
                                    </table>
                            	</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>Últimas transacciones realizadas de plata</h5>
                            </div>
                            <div class="ibox-content">
                                 <div class="table-responsive">
                                    <table class="table table-striped table-bordered table-hover tablita" >
                                        <thead>
                                        <tr>
                                            <th>Fecha</th>
                                            <th>Usuario</th>
                                            <!--<th>Sucursal</th>-->
                                            <th>Cantidad</th>
                                            <th>Precio</th>
                                            <th>Monto(USD)</th>
                                            <th>Tipo</th>
                                        </tr>
                                        </thead>
                                        <tbody>  
                                           {% for a in ultimas_cinco_ordenes_plata %} 
                                            <tr>
                                                <td>{{ fecha('D, d F, Y h:i a', a.fecha) }}</td>
                                                <td>{{ a.primer_nombre }} {{ a.primer_apellido }}</td>
                                                {#<td>{{ a.nombre_sucursal }}</td>#}
                                                <td>{{ a.cantidad }}</td>
                                                <td>{{ a.precio|number_format(2, ',', '.') }}</td>
                                                <td>{{ (a.cantidad * (a.precio / 28.3495))|number_format(2, ',', '.') }}</td>
                                                <td style="{{a.tipo_orden == 1 ? 'color: #DC2929;;' :  a.tipo_orden == 2  ? 'color: red;' : 'color: #3CD219;'}}">{{ a.tipo_orden == 1 ? 'Compra' :  a.tipo_orden == 2  ? "Venta" : "Intercambio" }}</td>
                                            </tr>
                                            {% endfor %}                           
                                        </tbody>
                                    </table>
                            	</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

{% include 'ordenes/compra' %}
{% include 'ordenes/venta' %}
{% include 'ordenes/intercambio' %}
{% include 'overall/footer' %}
</div>
{% endblock %}

{% block appFooter %}
    <script src="./assets/jscontrollers/ordenes/crear.js"></script>
    <script src="./assets/jscontrollers/home/dashboard.js"></script>
{% endblock %}